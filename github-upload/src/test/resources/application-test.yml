# 测试环境配置
spring:
  # 测试数据库配置 - 使用H2内存数据库
  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password: 
  
  # JPA配置
  jpa:
    hibernate:
      ddl-auto: create-drop
    database-platform: org.hibernate.dialect.H2Dialect
    show-sql: false
    properties:
      hibernate:
        format_sql: false
  
  # H2控制台（测试时可用）
  h2:
    console:
      enabled: true
      path: /h2-console
  
  # 缓存配置
  cache:
    type: simple
  
  # 日志配置
  logging:
    level:
      com.oceangpt: DEBUG
      org.springframework: WARN
      org.hibernate: WARN
    pattern:
      console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# OceanGPT模型配置
oceangpt:
  model:
    path: "src/test/resources/models/test_model.onnx"
    batch-size: 16
    max-sequence-length: 64
    inference-threads: 2
    mock-mode: true  # 测试模式，使用模拟数据
    
  # 预测配置
  prediction:
    confidence-threshold: 0.7
    max-batch-size: 100
    timeout-seconds: 30

# NOAA API配置
noaa:
  api:
    base-url: "https://api.test.noaa.gov"
    timeout: 10000
    retry-attempts: 2
    rate-limit: 100
    mock-mode: true  # 测试模式，使用模拟数据
    
  # 数据源配置
  data-sources:
    buoy: "test-buoy"
    satellite: "test-satellite"
    model: "test-model"

# 数据处理配置
data-processing:
  batch-size: 50
  max-workers: 2
  timeout-minutes: 5
  
  # 数据质量阈值
  quality:
    completeness-threshold: 0.8
    consistency-threshold: 0.9
    accuracy-threshold: 0.85
    timeliness-threshold: 0.95

# 性能配置
performance:
  async:
    core-pool-size: 2
    max-pool-size: 5
    queue-capacity: 50
  
  cache:
    max-size: 1000
    expire-after-write: 300  # 5分钟
    expire-after-access: 180  # 3分钟

# 监控配置
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      simple:
        enabled: true

# 测试特定配置
test:
  data:
    # 测试数据路径
    sample-ocean-data: "src/test/resources/data/sample_ocean_data.json"
    sample-noaa-response: "src/test/resources/data/sample_noaa_response.json"
    
  # 模拟配置
  mock:
    enable-model-simulation: true
    enable-noaa-simulation: true
    simulation-delay-ms: 100
    
  # 验证配置
  validation:
    enable-strict-validation: false
    allow-missing-data: true
    
# 服务器配置
server:
  port: 0  # 随机端口，避免测试冲突
  servlet:
    context-path: /api/test